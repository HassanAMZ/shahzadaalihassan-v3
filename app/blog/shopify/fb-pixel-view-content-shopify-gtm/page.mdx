export const metadata = {
 title:
  "Shopify, Facebook Pixel & Google Tag Manager Setup for View Content! ðŸš€",
 date: "2023-11-13",
 blogId: "00073",
 tags: ["Facebook Pixel", "Shopify", "Page View", "Tutorial"],
 draft: false,
 description: "",
 openGraph: {
  images: ["/static/blog/00013.png"],
 },
 embedId: "",
};

<BlogHeader metadata={metadata} />

#### Blog will be published soon

<YoutubeEmbed embedId={metadata.embedId} />

#### DataLayer Code Snippets Overview

The provided code snippets aim to integrate the `dataLayer` object for Google Tag Manager (GTM) with a Shopify store. The main goal is to send an event called `custom_view_item` whenever a user visits a product page on Shopify. This event can then be used in GTM to trigger the `view_item` event for Google Analytics 4 (GA4).

#### Head DataLayer Code

This code initializes the `dataLayer` array if it hasn't been already. It then checks if the current page template is a 'product' page and renders a specific snippet called 'datalayer-product'.

```jsx
<script>
    window.dataLayer = window.dataLayer || [];
</script>

{%- if template contains 'product' -%}
  {%- render 'datalayer-product', product: product -%}
{%- endif -%}
```

#### Product DataLayer Code

This code snippet contains the main logic for populating the `dataLayer` object with product details whenever a product page is viewed:

1. It first captures the current variant of the product.
2. It constructs an `itemObject` containing various product details.
3. On document load, it pushes this data to the `dataLayer` object.

```jsx
{%- liquid assign current_variant = product.selected_or_first_available_variant -%}

<script>
  console.log("datalayer-product snippet is loaded")
  var itemObject = {
      item_id: {{ current_variant.id | json }},
      id: {{ current_variant.id | json }},
      item_name: {{ product.title | json }},
      currency: {{ shop.currency | json }},
      item_brand: {{ product.vendor | json }},
      item_category: {{ product.type | json }},
      item_variant: {{ current_variant.title | json }},
      price: {{ current_variant.price }} / 100,
      google_business_vertical: 'retail',
      quantity: 1
  }

  document.addEventListener('DOMContentLoaded', () => {
      dataLayer.push({ ecommerce: null });
      dataLayer.push({
          event: "custom_view_item",
          ecommerce: {
          currency: {{ shop.currency | json }},
              items: [itemObject]
          }
      });
  })
</script>
```

#### Theme DataLayer Code

This code renders the `head-datalayer` snippet. Depending on the setup of your Shopify theme, this is likely where the head datalayer code resides. Add this code GTM Body Code.

```jsx
{% render 'head-datalayer' %}
```

#### Steps to Add the DataLayer Code Snippets in Shopify:

1. Backup: Before making any changes, always backup your current theme.

2. Access Theme Files:

   - Login to your Shopify Admin.
   - Go to Online Store > Themes.
   - Click on the "Actions" dropdown for your live theme and select "Edit code".

3. Add Head DataLayer Code:

   - In the left sidebar, locate and click on `theme.liquid`.
   - Insert the "Head DataLayer Code" snippet within the `<head>` tags.

4. Add Product DataLayer Code:

   - Click "Add a new template" or "Add a new snippet" depending on your Shopify version.
   - Name it `datalayer-product.liquid`.
   - Insert the "Product DataLayer Code" snippet into this new file.
   - Save changes.

5. Add Theme DataLayer Code:

   - Determine where you want this code to render (usually within the `<head>` tags in `theme.liquid`).
   - Insert the "Theme DataLayer Code" snippet in the desired location.
   - Save changes.

6. Test:
   - Visit a product page on your Shopify store.
   - Open browser's developer console.
   - Confirm that the `custom_view_item` event is fired and the `dataLayer` object contains the correct product details.

Remember, these instructions assume a typical Shopify setup. Some custom themes might require a different approach. Always test thoroughly before and after making changes.

<GiscusComments />
